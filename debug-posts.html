<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ› Debug Posts Issue</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #0a0a0a;
            color: #fff;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #1a1a1a;
            border-radius: 12px;
            border-left: 4px solid #ff2741;
        }
        .debug-section h3 {
            color: #ff2741;
            margin-top: 0;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
            font-size: 14px;
        }
        .success { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .info { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .warning { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        .error { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        button {
            background: #ff2741;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover { background: #d71e36; }
        .test-result {
            margin: 10px 0;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .app-frame {
            width: 100%;
            height: 500px;
            border: 2px solid #333;
            border-radius: 12px;
            background: #000;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="debug-section">
            <h3>ğŸ› æ–°å¸–å­ä¸æ˜¾ç¤ºé—®é¢˜è°ƒè¯•</h3>
            <div class="status info">
                <strong>é—®é¢˜æè¿°:</strong> ç”¨æˆ·åˆ›å»ºå¸–å­åï¼Œå¸–å­ä¸åœ¨ä¸»é¡µæ˜¾ç¤º<br>
                <strong>ä¿®å¤çŠ¶æ€:</strong> âœ… å·²ä¿®å¤ PostsContext æ•°æ®ç»“æ„é—®é¢˜
            </div>
        </div>

        <div class="debug-section">
            <h3>ğŸ”§ ä¿®å¤å†…å®¹</h3>
            <div class="status success">
                <strong>âœ… PostsContextä¿®å¤:</strong><br>
                â€¢ æ·»åŠ äº† posts å­—æ®µï¼ˆåˆå¹¶ç”¨æˆ·å¸–å­+é»˜è®¤å¸–å­ï¼‰<br>
                â€¢ æ·»åŠ äº†é»˜è®¤ç¤ºä¾‹å¸–å­æ•°æ®<br>
                â€¢ æŒ‰æ—¶é—´æ’åºæ˜¾ç¤ºå¸–å­<br>
                â€¢ ä¿®å¤äº†æ•°æ®ç»“æ„ä¸åŒ¹é…é—®é¢˜<br><br>
                
                <strong>âœ… UploadFormä¿®å¤:</strong><br>
                â€¢ å®Œå–„äº†å¸–å­æ•°æ®ç»“æ„ï¼ˆæ·»åŠ  image, media, description ç­‰å­—æ®µï¼‰<br>
                â€¢ ç»Ÿä¸€äº†ä½œè€…ä¿¡æ¯æ ¼å¼<br>
                â€¢ æ·»åŠ äº† likesCount, savesCount å­—æ®µ<br><br>
                
                <strong>âœ… ProfilePageä¿®å¤:</strong><br>
                â€¢ ä¿®å¤äº†å˜é‡åå†²çªé—®é¢˜<br>
                â€¢ æ­£ç¡®è·å–ç”¨æˆ·å¸–å­æ•°æ®
            </div>
        </div>

        <div class="debug-section">
            <h3>ğŸ§ª æµ‹è¯•æ­¥éª¤</h3>
            <button onclick="testLocalStorage()">æ£€æŸ¥ localStorage</button>
            <button onclick="testPostStructure()">æ£€æŸ¥å¸–å­ç»“æ„</button>
            <button onclick="clearStorage()">æ¸…ç©ºå­˜å‚¨</button>
            <button onclick="openApp()">æ‰“å¼€åº”ç”¨</button>
            
            <div id="test-results"></div>
        </div>

        <div class="debug-section">
            <h3>ğŸ“ éªŒè¯æ¸…å•</h3>
            <div class="status warning">
                <strong>éªŒè¯æ­¥éª¤:</strong><br>
                1. æ‰“å¼€åº”ç”¨ï¼Œç¡®è®¤ä¸»é¡µæ˜¾ç¤º3ä¸ªé»˜è®¤ç¤ºä¾‹å¸–å­<br>
                2. ç™»å½•è´¦æˆ·ï¼ˆå¦‚æœéœ€è¦ï¼‰<br>
                3. è¿›å…¥ /upload é¡µé¢åˆ›å»ºæ–°å¸–å­<br>
                4. æäº¤ååº”è¯¥è·³è½¬åˆ°ä¸»é¡µ<br>
                5. æ–°åˆ›å»ºçš„å¸–å­åº”è¯¥å‡ºç°åœ¨åˆ—è¡¨é¡¶éƒ¨<br>
                6. ç‚¹å‡»å¸–å­å¡ç‰‡ï¼Œç¡®è®¤æ¨¡æ€æ¡†æ­£å¸¸æ‰“å¼€<br>
                7. æµ‹è¯•ç‚¹èµ/æ”¶è—åŠŸèƒ½<br>
                8. è¿›å…¥ /profile é¡µé¢ï¼Œåœ¨ Posts æ ‡ç­¾ä¸‹çœ‹åˆ°è‡ªå·±çš„å¸–å­
            </div>
        </div>

        <div class="debug-section">
            <h3>ğŸ–¥ï¸ åº”ç”¨é¢„è§ˆ</h3>
            <iframe id="app-frame" class="app-frame" src="http://localhost:5177/"></iframe>
        </div>
    </div>

    <script>
        function updateResults(content) {
            document.getElementById('test-results').innerHTML = content;
        }

        function testLocalStorage() {
            const results = [];
            
            // æ£€æŸ¥ userPosts
            const userPosts = localStorage.getItem('userPosts');
            results.push(`<div class="test-result ${userPosts ? 'success' : 'warning'}">
                userPosts: ${userPosts ? JSON.parse(userPosts).length + ' ä¸ªå¸–å­' : 'æ— æ•°æ®'}
            </div>`);
            
            // æ£€æŸ¥ likedPosts
            const likedPosts = localStorage.getItem('likedPosts');
            results.push(`<div class="test-result ${likedPosts ? 'info' : 'warning'}">
                likedPosts: ${likedPosts ? JSON.parse(likedPosts).length + ' ä¸ª' : 'æ— æ•°æ®'}
            </div>`);
            
            // æ£€æŸ¥ savedPosts
            const savedPosts = localStorage.getItem('savedPosts');
            results.push(`<div class="test-result ${savedPosts ? 'info' : 'warning'}">
                savedPosts: ${savedPosts ? JSON.parse(savedPosts).length + ' ä¸ª' : 'æ— æ•°æ®'}
            </div>`);
            
            updateResults(results.join(''));
        }

        function testPostStructure() {
            const userPosts = localStorage.getItem('userPosts');
            if (!userPosts) {
                updateResults('<div class="test-result warning">æ²¡æœ‰æ‰¾åˆ°ç”¨æˆ·å¸–å­æ•°æ®</div>');
                return;
            }
            
            const posts = JSON.parse(userPosts);
            if (posts.length === 0) {
                updateResults('<div class="test-result warning">ç”¨æˆ·å¸–å­åˆ—è¡¨ä¸ºç©º</div>');
                return;
            }
            
            const lastPost = posts[0];
            const requiredFields = ['id', 'title', 'content', 'image', 'author', 'createdAt'];
            const missingFields = requiredFields.filter(field => !lastPost[field]);
            
            let result = `<div class="test-result success">
                æœ€æ–°å¸–å­ç»“æ„æ£€æŸ¥:<br>
                ID: ${lastPost.id}<br>
                æ ‡é¢˜: ${lastPost.title}<br>
                ä½œè€…: ${lastPost.author?.name}<br>
                åˆ›å»ºæ—¶é—´: ${lastPost.createdAt}
            </div>`;
            
            if (missingFields.length > 0) {
                result += `<div class="test-result error">
                    ç¼ºå°‘å­—æ®µ: ${missingFields.join(', ')}
                </div>`;
            }
            
            updateResults(result);
        }

        function clearStorage() {
            localStorage.removeItem('userPosts');
            localStorage.removeItem('likedPosts');
            localStorage.removeItem('savedPosts');
            updateResults('<div class="test-result warning">å·²æ¸…ç©ºæ‰€æœ‰localStorageæ•°æ®</div>');
        }

        function openApp() {
            document.getElementById('app-frame').src = 'http://localhost:5177/';
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.onload = function() {
            testLocalStorage();
            console.log('ğŸ› Debugé¡µé¢å·²åŠ è½½');
            console.log('ğŸ“ æ£€æŸ¥localStorageå’Œå¸–å­ç»“æ„');
        };
    </script>
</body>
</html>